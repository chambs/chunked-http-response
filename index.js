const express = require('express');
const http = require('http');
const app = express();
const static = express.static(__dirname + '/static');

app.use(static);

app.get('/chunk', (req, res) => {
  res.setHeader('Content-Type', 'text/plain');
  res.setHeader('Transfer-Encoding', 'chunked, gzip');
  
  let counter = 0;
  const MAX = 20;

  let id = setInterval(() => {
    counter += 1;
    if (counter > MAX) {
      clearInterval(id);
      res.end();
    } else {
      const data = `{"__typename":"Offer","productId":"351335","productShortName":"Magenta Zuhause M","rank":"0","internetSpeed":{"download":50,"upload":10},"provider":{"id":59020,"logoSvg":"https://partner.vxcp.de/_images/provider/broadband/59020.svg","logoImg":"https://t380.vx.dev/i/vox-carrierlogo.ashx?id=59020","name":"Telekom"},"tariffOverview":{"accessMode":"DSL","hasTelephonyOption":true,"hasTvOption":false,"hasFlatRate":true},"tariffRatings":{"grade":"1,8","gradeText":"gut","date":"07/2018"},"prices":{"monthly":"19,11 €/Monat","totals":"19,11 €","savingsPercent":52,"totalCosts25":39.95},"signUpLinks":{"desktop":"https://t380.vx.dev/jump/jump.aspx?gc=true&carrier_id=59020&source_id=1&site_id=8&tariff_id=351335","responsive":"https://t380.vx.dev/internetanbieter/Telekom/351335/?productId=351335&clu=3&cl=24&downSpeed=50000&upSpeed=10000&productCampaignId=19103&voucher=1&tv=0&wlan=0&freeHardwareWanted=0&telephony=2&dsl=1&cable=1&vierg=0&satellite=1&thome=0&trafficLimitation=1&customer=1&prefix=0211&simcard=0&surfstick=0&customerType=2&remainingTerm=0&includeCashBackCampaigns=1&isForStudents=0&isSpecialOffer=0&isForBusinessCustomers=0"},"remarks":[{"header":"180 € Sofortbonus von Verivox","body":"Bei Bestellung erhalten Sie einen Bonus in Höhe von 180 Euro, wenn Sie diesen Vertrag von der Telekom hier abschließen. Für die Auszahlung Ihres Sofortbonus bitten wir Sie, unter https://www.verivox.de/service/dateneingabe/ Ihre erste vollständige Kalendermonatsrechnung bis spätestens 6 Monate nach Vertragsabschluss hochzuladen. Die Auszahlung des Sofortbonus erfolgt auf die bei Vertragserstellung angegebene Bankverbindung.","type":"cashBack","caption":"Verivox Vorteil"},{"header":"Inkl. Festnetz-Flat","body":"Telefon-Flat ins deutsche Festnetz enthalten","type":"flatrateIncluded","caption":"Inkl. Festnetz-Flat"}],"userRatings":{"total":0,"percent":0,"body":"","description":"","ratingItems":{"customerService":{"caption":"","percent":0,"rating":""},"pricePerformance":{"caption":"","percent":0,"rating":""},"termsCondition":{"caption":"","percent":0,"rating":""}}},"files":[{"caption":"AGB Telekom Januar 2018","url":"https://t380.vx.dev/i/vox-filehandler.ashx?fileid=625341"},{"caption":"Leistungsbeschreibung Telekom Oktober 2018","url":"https://t380.vx.dev/i/vox-filehandler.ashx?fileid=663373"},{"caption":"Preisliste Telekom Nov 2018","url":"https://t380.vx.dev/i/vox-filehandler.ashx?fileid=663391"},{"caption":"Produktinformationsblatt_MagentaZuhause_M","url":"https://t380.vx.dev/i/vox-filehandler.ashx?fileid=671249"}],"themes":{"tooltipHeader":"","tooltipBody":"","bannerBackgroundColor":"","bannerTextColor":""},"goodies":{"id":"","name":"","type":null,"cost":"","includedInTotalCost":false,"imageUrl":"","remark":"","shortRemark":""},"contractDuration":{"caption":"Laufzeit","header":"Laufzeit","period":"24 Monate"},"cancellationPeriod":{"caption":"Kündigungsfrist","header":"Kündigungsfrist","period":"1 Monat"},"prolongationPeriod":{"caption":"Automatische Verlängerung bei Nichtkündigung","header":"Automatische Verlängerung bei Nichtkündigung","period":"12 Monate"},"hardwareItems":[{"name":"Speedport Smart 3","type":"WLAN Router","cost":"4,94 €/Monat","imageUrl":"https://t380.vx.dev/i/vox-filehandler.ashx?fileid=412142","remark":"Der Speedport Smart ist optimal geeignet für Entertain, Highspeed-Internet und IP-basierte Telefonie. Desweiteren können Sie WLAN TO GO nutzen und erhalten einen WLAN-Gastzugang.\nMit WLAN TO GO können Sie kostenlos an allen Telekom HotSpots in Deutschland sowie weltweit an über 20 Millionen Hotspots des Partners Fon per WLAN im Internet surfen.","shortRemark":"kostenlose Nutzung aller Telekom HotSpots inklusive"}],"additionalOptions":[{"optionType":"Extra","name":"Persönliche Installation","recurringCost":"kostenlos","oneTimeCost":"99,95 € einmalig","remark":"- Einmaliger Festpreis 99,95 Euro in Verbindung mit MagentaZuhause Paketen ohne MagentaTV \n<br>- Installationsangebot gilt nur für PCs und Notebooks \n<br>- Installationsangebot enthält keine Hardwarekomponenten, keine weiteren Webdienstleistungen, keine Server, keine Einrichtung/Beantragung Webpräsenz. Weitere Dienstleistungen vor Ort werden nach Aufwand berechnet.","shortRemark":"Einrichtung Ihres MagentaZuhause-Paketes"},{"optionType":"Telefon","name":"Festnetz zu Telekom Mobil Flat IP","recurringCost":"14,95 €/Monat","oneTimeCost":"kostenlos","remark":"Zum Festpreis unbegrenzt ins Telekom Mobilfunknetz telefonieren.","shortRemark":""},{"optionType":"Telefon","name":"Festnetz zu Mobil IP","recurringCost":"kostenlos","oneTimeCost":"kostenlos","remark":"Zum Preis von 12,9 Cent/Minute in alle deutschen Mobilfunknetze telefonieren.","shortRemark":"<b>Mindestumsatz: 4 €/Monat.</b>"},{"optionType":"Telefon","name":"CountryFlat 1","recurringCost":"3,94 €/Monat","oneTimeCost":"kostenlos","remark":"Gilt für folgende Länder:\n<br><br>Andorra, Australien, Belgien, Dänemark, Frankreich, Griechenland, Großbritannien (England, Schottland & Nordirland), Irland, Italien, Kanada, Liechtenstein, Luxemburg, Monaco, Niederlande, Norwegen, Österreich, Polen, Portugal, San Marino, Schweden, Schweiz, Spanien, Tschechien, USA und Vatikanstadt.","shortRemark":"Die Flatrate fürs benachbarte Ausland, USA, Kanada, Australien und Westeuropa"},{"optionType":"Telefon","name":"CountryFlat 2","recurringCost":"14,95 €/Monat","oneTimeCost":"kostenlos","remark":"Gilt für folgende Länder:\n<br><br>\nArgentinien, Brasilien, Bulgarien, Chile, China, Estland, Georgien, Hongkong, Island, Israel, Japan, Kroatien, Malaysia, Neuseeland, Rumänien, Russische Föderation, Singapur, Slowakei, Slowenien, Südafrika, Taiwan, Türkei, Ungarn, Venezuela und Zypern.","shortRemark":"Die Flatrate für die Türkei, Russische Föderation, Osteuropa und zahlreiche Fernziele."}],"priceDetails":{"totalDescription":"Durchschnitt / Monat","taxInfo":"Alle angegebenen Preise sind Bruttopreise inkl. MwSt.","total":19.11,"followUp":{"invoiceItems":[{"text":"Grundgebühr ab dem 25.&nbsp;Monat","price":39.95,"invoiceType":"baseFeeStandard","isRecurring":true}],"description":"monatlich","totals":[{"total":39.95,"text":"Monatliche Kosten ab dem 25. Monat","isRecurring":true}]},"initial":{"invoiceItems":[{"text":"Aktions-Grundgebühr 1. - 6. Monat","price":19.95,"invoiceType":"baseFeePromo","isRecurring":true},{"text":"Grundgebühr 7. - 24. Monat","price":39.95,"invoiceType":"baseFeeStandard","isRecurring":true},{"text":"Grundgebührermäßigung 1. - 24. Monat","price":-4.17,"invoiceType":"baseFeeReduction","isRecurring":true},{"text":"Einrichtungsgebühr","price":0,"invoiceType":"setupFee","isRecurring":false},{"text":"Sofortbonus","price":-180,"invoiceType":"cashBack","isRecurring":false},{"text":"Telekom-Vorteil","price":-100,"invoiceType":"startingBonus","isRecurring":false}],"description":"monatlich","totals":[{"total":738.72,"text":"Summe über 24 Monate","isRecurring":true},{"total":-280,"text":"Summe einmaliger Kosten","isRecurring":false}]}},"telephony":{"lines":2,"phoneNumbers":3}}__LERO__`.replace(/\s/g, ' ');
      res.write(data);
    }
  }, 200);
});

http.createServer(app).listen(9090);
